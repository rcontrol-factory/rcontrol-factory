<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>RControl Factory</title>

  <meta name="theme-color" content="#0b1020" />
  <link rel="manifest" href="/manifest.json" />
  <link rel="stylesheet" href="/styles.css" />

  <!-- iOS/PWA -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body>
  <noscript>Ative o JavaScript para usar o app.</noscript>

  <div id="app">
    <div style="padding:14px;font-family:system-ui">Carregando…</div>
  </div>

  <!-- (1) Core modules que habilitam os botões -->
  <script src="/js/core/github_sync.js"></script>
  <script src="/js/core/vfs_overrides.js"></script>
  <script src="/js/core/mother_selfupdate.js"></script>

  <!-- (2) Engine/builder (se estiver usando) -->
  <script src="/js/engine/patchQueue.js"></script>
  <script src="/js/engine/organizerEngine.js"></script>
  <script src="/js/engine/applyPipeline.js"></script>
  <script src="/js/builder/builderSafe.js"></script>

  <!-- (3) App principal -->
  <script src="/app.js"></script>

  <!-- (4) SW: registra só se existir sw.js e evita travar -->
  <script>
    (function () {
      if (!("serviceWorker" in navigator)) return;

      // tenta registrar /sw.js na raiz
      navigator.serviceWorker.getRegistration("/")
        .then((reg) => {
          if (reg) return reg; // já existe
          return navigator.serviceWorker.register("/sw.js", { scope: "/" });
        })
        .catch(() => {});
    })();
  </script>
</body>
</html>

<!--
  RControl Factory — INDEX (NORMAL BOOT) vCLEAN-2
  ✅ Sem SAFE BOOT embutido
  ✅ Sem loader manual (sem loadScript / sem lista dinâmica / sem watchdog)
  ✅ Boot via <script defer> padrão
  ✅ Mantém o “app root” (#app) simples e estável

  NOTA:
  - Safe Boot deve ficar em arquivo separado (ex.: /app/safe.html) e só ser usado em emergência.
  - Este index não injeta UI extra nem intercepta eventos.
-->

<!doctype html>
<html lang="pt-BR">
<head>
  <!-- Core -->
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />

  <title>RControl Factory</title>
  <meta name="theme-color" content="#0b1020" />
  <meta name="color-scheme" content="dark light" />

  <!-- RCF marker -->
  <meta name="rcf-index" content="NORMAL_BOOT_2026_02_24_vCLEAN_2" />

  <!-- PWA -->
  <base href="./" />
  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" href="./favicon.ico" />
  <link rel="apple-touch-icon" href="./icons/icon-192.png" />

  <!-- Styles -->
  <link rel="stylesheet" href="./styles.css" />

  <!-- Fallback visual mínimo (não é SafeBoot; é só “splash” neutro) -->
  <style>
    html, body { height: 100%; }
    body {
      margin: 0;
      background: #0b1020;
      color: #eaf0ff;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    .rcf_splash {
      min-height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 18px;
      box-sizing: border-box;
    }
    .rcf_splash_card {
      max-width: 720px;
      width: 100%;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 18px;
      padding: 16px 14px;
      box-sizing: border-box;
    }
    .rcf_splash_title {
      font-size: 18px;
      font-weight: 900;
      margin: 0 0 8px 0;
      letter-spacing: .2px;
    }
    .rcf_splash_hint {
      opacity: .86;
      font-size: 13px;
      line-height: 1.35;
      margin: 0;
    }
  </style>

  <!--
    BOOT PADRÃO (scripts estáticos com defer)
    IMPORTANTE: não mudar ordem sem necessidade.
  -->

  <!-- Core / boot safety -->
  <script defer src="./js/core/logger.js"></script>
  <script defer src="./js/core/stability_guard.js"></script>

  <!-- Storage + GitHub + VFS + MAE + updates -->
  <script defer src="./js/core/storage.js"></script>
  <script defer src="./js/core/github_sync.js"></script>
  <script defer src="./js/core/vfs_overrides.js"></script>
  <script defer src="./js/core/vfs_shim.js"></script>
  <script defer src="./js/core/mother_selfupdate.js"></script>

  <!-- Errors + UI safety/compact -->
  <script defer src="./js/core/errors.js"></script>
  <script defer src="./js/core/ui_safety.js"></script>
  <script defer src="./js/core/ui_compact_outputs.js"></script>

  <!-- UI bindings + diagnostics + preview -->
  <script defer src="./js/core/ui_bindings.js"></script>
  <script defer src="./js/core/diagnostics.js"></script>
  <script defer src="./js/core/preview_runner.js"></script>

  <!-- Injector + engine pipeline -->
  <script defer src="./js/core/injector.js"></script>
  <script defer src="./js/engine/template_registry.js"></script>
  <script defer src="./js/engine/module_registry.js"></script>
  <script defer src="./js/engine/builder.js"></script>
  <script defer src="./js/engine/engine.js"></script>

  <!-- Pages links + Admin GH -->
  <script defer src="./js/core/pages_links.js"></script>
  <script defer src="./js/admin.github.js"></script>

  <!-- App main -->
  <script defer src="./app.js"></script>

  <!-- Vault / ZIP -->
  <script defer src="./js/core/zip_vault.js"></script>
  <script defer src="./js/core/agent_zip_bridge.js"></script>

</head>

<body>
  <noscript>Ative o JavaScript para usar a RControl Factory.</noscript>

  <!-- Root único e fixo -->
  <div id="app">
    <!-- Splash neutro (o app substitui/atualiza o conteúdo ao montar) -->
    <div class="rcf_splash" aria-label="RCF carregando">
      <div class="rcf_splash_card">
        <h1 class="rcf_splash_title">RControl Factory</h1>
        <p class="rcf_splash_hint">
          Carregando módulos…<br/>
          Se ficar preso, use o Safe Boot separado (emergência).
        </p>
      </div>
    </div>
  </div>

  <!--
    Sem SAFE BOOT aqui.
    Sem loader JS aqui.
    Sem timers aqui.
    Sem listeners globais aqui.
  -->
</body>
</html>
